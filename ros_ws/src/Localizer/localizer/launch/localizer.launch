<launch>
    <arg name="video_device" default="/dev/video1"/>
    <arg name="camera_info_file" default="file://$(find localizer)/camera_info/head_camera.yaml"/>
    <arg name="map_frame" default="map"/>
    <arg name="odom_frame" default="odom"/>
    <arg name="base_frame" default="base_link"/>

    <!-- <node name="usb_cam" pkg="usb_cam" type="usb_cam_node" output="screen" >
        <param name="video_device" value="$(arg video_device)" />
        <param name="camera_info_url" value="$(arg camera_info_file)" />
        <param name="image_width" value="640" />
        <param name="image_height" value="480" />
        <param name="pixel_format" value="yuyv" />
        <param name="io_method" value="mmap"/>
    </node> -->

    <include file="$(find localizer)/launch/camera.launch">
        <arg name="video_device" value="$(arg video_device)"/>
        <arg name="camera_info_file" value="$(arg camera_info_file)"/>
    </include>

    <node pkg="aruco_detect" name="aruco_detect" type="aruco_detect" output="screen" respawn="false">
        <param name="image_transport" value="raw"/>
        <param name="publish_images" value="true"/>
        <param name="do_pose_estimation" value="true"/>
        <remap 
            from="/camera" 
            to="/usb_cam/image_raw"
        />
        <remap from="/camera_info" to="/usb_cam/camera_info"/>
    </node>

    <node type="fiducial_slam" pkg="fiducial_slam" output="screen" name="fiducial_slam">
        <param name="map_file" value="$(find localizer)/map.txt"/>
        <param name="map_frame" value="$(arg map_frame)" />
        <param name="odom_frame" value="$(arg odom_frame)" />
        <param name="base_frame" value="$(arg base_frame)" />
        <param name="publish_6dof_pose" value="true" />
    </node>
</launch>
